# Implementation Plan

## 新機能追加タスク

- [x] 16. ユーザー名保持機能の実装




- [x] 16.1 localStorage管理ユーティリティの作成


  - UserNameStorageユーティリティクラスの実装
  - 保存・取得・削除・期限チェック機能
  - 7日間の有効期限管理
  - _Requirements: 7.1, 7.5, 7.6_

- [x] 16.2 アップロード画面での名前自動入力機能


  - ImageUpload.tsxにlocalStorage連携を追加
  - コンポーネントマウント時に保存された名前を読み込み
  - 名前入力時に自動保存
  - クリアボタンの実装
  - _Requirements: 7.2, 7.3, 7.4_

- [x] 17. 削除リクエスト機能の実装（バックエンド）




- [x] 17.1 SNSトピックとSubscriptionの作成


  - CDK StackにSNSトピックを追加
  - Email Subscriptionの設定
  - 環境変数でのメールアドレス管理
  - _Requirements: 8.4, 8.5_



- [x] 17.2 Delete Request Lambda関数の実装

  - deleteRequest.js Lambda関数の作成
  - リクエストバリデーション（画像ID、削除理由）
  - DynamoDBから画像メタデータ取得
  - SNS通知送信（件名にphotoId含む）


  - エラーハンドリング
  - _Requirements: 8.3, 8.4, 8.5, 8.7, 8.8_


- [x] 17.3 API Gatewayエンドポイントの追加

  - /api/delete-request エンドポイントの作成
  - Lambda関数との統合
  - CORS設定の適用
  - _Requirements: 8.3_

- [x] 18. 削除リクエスト機能の実装（フロントエンド）




- [x] 18.1 DeleteRequestDialogコンポーネントの作成

  - 削除理由入力フィールド（任意）
  - 確認ダイアログの実装
  - API呼び出し処理
  - 成功・エラーフィードバック表示
  - _Requirements: 8.2, 8.3, 8.6, 8.7, 8.8_

- [x] 18.2 画像詳細モーダルへの削除ボタン追加


  - HomePage.tsxの画像詳細モーダルに「削除リクエストを送る」ボタンを追加
  - 控えめなデザインで配置
  - DeleteRequestDialogとの連携
  - _Requirements: 8.1, 8.2_

## 追加要件対応タスク（既存実装の改善）

- [x] 15. モバイル最適化とデザイン統一





- [x] 15.1 ドラッグ&ドロップエリアの削除


  - ImageUpload.tsx からドラッグ&ドロップ機能を完全削除
  - ファイル選択ボタンとカメラボタンのみに簡素化
  - _Requirements: 1.4, 5.1_

- [x] 15.2 チェックボックス操作性向上


  - ChecklistForm.tsx のラベル全体をクリック可能に改善
  - 既存のラベル要素のクリックエリア拡張
  - _Requirements: 3.2, 3.3_

- [x] 15.3 ページネーションボタンの金色統一


  - HomePage.tsx のページネーションボタンを金色（#FFD700）に変更
  - 既存のTailwind CSSクラスを金色系に置換
  - _Requirements: 4.6_

- [x] 15.4 画像詳細モーダルの閉じるボタン金色統一


  - HomePage.tsx の画像詳細モーダル閉じるボタンを金色（#FFD700）に変更
  - 既存のボタンスタイルを金色系に調整
  - _Requirements: 4.7_

- [x] 15.5 フローティングアップロードボタンの追加


  - HomePage.tsx にスクロール監視機能付きフローティングボタンを追加
  - 下スクロール時に右下に表示される円形ボタン
  - _Requirements: 1.8, 5.3_

# 既存実装タスク（完了済み）

- [x] 1. プロジェクト初期設定とGitHub管理

- [x] 1.1 プロジェクト基盤とGit設定

  - Node.js プロジェクトの初期化（package.json作成）
  - Git リポジトリの初期化と .gitignore 設定
  - README.md の作成（デプロイ手順、環境設定を含む）
  - プロジェクト構造の作成（frontend/, backend/, infrastructure/フォルダ）
  - _Requirements: 5.1, 5.2_

- [x] 1.2 CDK環境構築と設定管理

  - AWS CDK のインストールと初期設定
  - TypeScript設定ファイル（tsconfig.json）の作成
  - 環境別設定ファイル（dev, prod）の作成
  - CDK コンテキスト設定（cdk.json）の作成
  - _Requirements: 5.1, 5.2_

- [x] 2. CDK インフラストラクチャの基盤実装

  - CDK Stack クラスの作成
  - DynamoDB テーブル（Photos, Config）の定義
  - S3 バケット（静的サイト + 画像保存）の作成
  - CloudFront Distribution の設定
  - _Requirements: 5.1, 5.2, 5.3_

- [x] 3. Lambda 関数の基本構造実装

- [x] 3.1 Upload Lambda 関数の実装

  - 基本的なLambda関数の作成
  - API Gateway との統合設定
  - 環境変数の設定（DynamoDB テーブル名、S3バケット名）
  - 基本的なエラーハンドリングの実装
  - _Requirements: 1.5, 1.6, 1.7_

- [x] 3.2 List Lambda 関数の実装

  - 画像一覧取得のLambda関数作成
  - DynamoDB からのデータ取得ロジック
  - 新着順ソート機能の実装
  - S3 Presigned URL 生成機能
  - _Requirements: 4.1, 4.2_

- [x] 3.3 Config Lambda 関数の実装

  - 確認項目設定取得のLambda関数作成
  - DynamoDB Config テーブルからの設定読み込み
  - JSON レスポンス形式の実装
  - _Requirements: 3.1, 3.4_

- [x] 4. API Gateway の設定と統合
  - REST API の作成と設定
  - CORS 設定の実装
  - Lambda 関数との統合設定
  - エンドポイント（/api/upload, /api/photos, /api/config）の定義
  - _Requirements: 5.4_

- [x] 5. React フロントエンドの基盤構築
- [x] 5.1 React プロジェクトのセットアップ

  - Vite + React + TypeScript プロジェクトの作成
  - Tailwind CSS の設定とインストール
  - React Router の設定
  - 基本的なプロジェクト構造の作成
  - _Requirements: 5.1_

- [x] 5.2 共通コンポーネントの実装

  - Layout コンポーネントの作成
  - Navigation コンポーネントの実装
  - Loading コンポーネントの作成
  - Error Message コンポーネントの実装
  - _Requirements: 4.2, 4.3_

- [x] 6. 画像アップロード機能の実装- [x] 6.1 ファイル選択とプレビュー機能

  - ファイル選択ボタンの実装
  - ドラッグ&ドロップエリアの作成
  - カメラ撮影ボタン（モバイル対応）の実装
  - 画像プレビュー表示機能の実装
  - _Requirements: 1.1, 1.2, 1.3, 1.4_

- [x] 6.2 ファイルバリデーション機能

  - ファイルサイズ制限（10MB）の実装
  - 画像形式チェック（MIMEタイプ `image/*`）の実装
  - バリデーションエラー表示の実装
  - _Requirements: 1.5, 1.6, 1.7_

- [x] 6.3 メタデータ入力フォーム

  - 名前入力フィールド（任意）の実装
  - コメント入力フィールド（任意）の実装
  - フォームバリデーションの実装
  - _Requirements: 2.1, 2.2, 2.3, 2.4_

- [x] 7. 確認項目チェック機能の実装- [x] 7.1 動的確認項目の取得と表示

  - Config API からの確認項目取得
  - チェックボックス一覧の動的生成
  - 注意事項の表示（パブリック公開、行動規範、自動削除）
  - _Requirements: 3.1, 3.4_

- [x] 7.2 確認項目バリデーション

  - 全項目チェック必須のバリデーション実装
  - 未チェック時のエラーメッセージ表示
  - アップロード前の最終確認
  - _Requirements: 3.2, 3.3_

- [x] 8. アップロード処理の実装
- [x] 8.1 フロントエンド側アップロード処理

  - FormData の作成と送信
  - アップロード進捗表示の実装
  - 成功・エラー時の処理
  - _Requirements: 1.1, 1.2, 1.3_

- [x] 8.2 バックエンド側アップロード処理

  - S3 への画像アップロード機能
  - ファイル名生成ロジック（投稿者名_日時_ランダム文字）
  - DynamoDB へのメタデータ保存
  - TTL設定（30日後削除）の実装
  - _Requirements: 1.1, 1.5, 2.1, 2.2_

- [x] 9. 画像一覧表示機能の実装
- [x] 9.1 基本的な一覧表示

  - 画像一覧の取得と表示
  - 新着順でのソート表示
  - レスポンシブデザインの実装（Tailwind CSS）
  - _Requirements: 4.1, 4.2_

- [x] 9.2 表示レイアウト切り替え機能

  - マソンリーレイアウトの実装（デフォルト）
  - カードグリッドレイアウトの実装
  - 表示切り替えボタンの実装
  - レイアウト状態の管理
  - _Requirements: 4.3, 4.4, 4.5_

- [x] 10. エラーハンドリングとユーザビリティ向上- [x] 10.1 包括的なエラーハンドリング

  - ネットワークエラーの処理
  - サーバーエラーの処理
  - ユーザーフレンドリーなエラーメッセージ
  - _Requirements: 4.6, 4.7_

- [x] 10.2 ローディング状態とUX改善

  - アップロード中のローディング表示
  - 画像読み込み中のスケルトン表示
  - 成功時のフィードバック表示
  - _Requirements: 1.1, 4.1_

- [x] 11. CDK デプロイメント設定の完成
- [x] 11.1 IAM 権限の設定

  - Lambda 関数の最小権限設定
  - S3 バケットアクセス権限の設定
  - DynamoDB テーブルアクセス権限の設定
  - _Requirements: 5.3_

- [x] 11.2 環境変数と設定の管理

  - Lambda 関数への環境変数設定
  - CDK コンテキスト値の設定
  - 環境別デプロイメント用スクリプトの作成
  - AWS プロファイル対応の設定
  - _Requirements: 5.1, 5.2_

- [x] 12. 初期データとテスト用設定
- [x] 12.1 Config テーブルの初期データ投入

  - 確認項目の初期設定データ作成
  - DynamoDB への初期データ投入スクリプト
  - 設定変更用の管理機能（将来拡張用）
  - _Requirements: 3.1, 3.4, 3.5_

- [x] 12.2 フロントエンドのビルドとデプロイ設定

  - React アプリケーションのビルド設定
  - S3 への静的サイトデプロイ設定
  - CloudFront キャッシュ設定の最適化
  - _Requirements: 5.1, 4.2_

- [x] 13. 統合テストと動作確認- [x] 13.1 エンドツーエンドテスト

  - アップロード機能の動作確認
  - 画像一覧表示の動作確認
  - 確認項目機能の動作確認
  - レスポンシブデザインの確認
  - _Requirements: 1.1-1.7, 2.1-2.4, 3.1-3.5, 4.1-4.7_

- [x] 13.2 ブラウザ互換性とモバイル対応確認

  - 各種ブラウザでの動作確認
  - モバイルデバイスでの動作確認
  - カメラ機能の動作確認
  - _Requirements: 1.2, 1.3, 4.2_

- [x] 14. GitHub管理とマルチ環境デプロイ対応
  - 既にこちらで対応済のため、gitコマンドにて現状確認のうえ、やるべきことだけをやってほしい
- [x] 14.1 GitHub リポジトリの整備

  - GitHub リポジトリの作成とプッシュ
  - ブランチ戦略の設定（main, develop）
  - Issue テンプレートの作成
  - Pull Request テンプレートの作成
  - _Requirements: 5.1, 5.2_

- [x] 14.2 マルチ環境デプロイ設定

  - 環境別設定ファイルの作成（config/dev.json, config/prod.json）
  - CDK Stack名の環境別命名規則実装
  - AWS アカウント・リージョン別デプロイ対応
  - デプロイ手順書の作成（README.md更新）
  - _Requirements: 5.1, 5.2_

- [x] 14.3 フォーク対応とドキュメント整備

  - 環境変数設定手順の文書化
  - AWS 認証情報設定手順の文書化
  - 初回デプロイ手順の詳細化
  - トラブルシューティングガイドの作成
  - _Requirements: 5.1, 5.2_
